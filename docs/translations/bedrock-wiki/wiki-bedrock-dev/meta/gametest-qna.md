---
title: GameTest 问答 2021/08/06
category: 问与答
mentions:
    - GTB3NW
    - SirLich
    - MedicalJewel105
    - Luthorius
    - IlkinQafarov
    - Herobrine643928
---

这次问答在[Bedrock 附加包 Discord 服务器](https://discord.gg/NGeNhZpvzV)举行。五位微软员工加入我们，回答了关于 Gametest 框架的问题。问题来自社区。

_警告：_ 不是所有消息都被复制过来，有些内容经过了编辑。如果你想查看全部内容，请加入上述 Discord，并获取“事件档案”角色。

## Realms

- **问**：Gametest 设计是否支持在 Realms 上运行？

- **答**：是的。

## QuickJS 与 V8

- **问**：选择 QuickJS 而不是其他 JavaScript 选项如 V8 的原因是什么？QuickJS 速度较慢（主要因为缺乏 JIT），在一些社区中这是使用它的一个大缺点。

- **答**：我们中的一些人在过去的项目中使用过 QuickJS，它非常容易集成。我们已经查看了 V8（和其他引擎），并且未来可能会迁移到它们。JIT 非常理想，但不是所有平台都支持它（轻松或根本不支持）。

## 文件与网络访问

- **问**：Gametest 是否会有文件或网络接口？

- **答**：我们希望默认情况下保持脚本 API 更加有限，并随着时间的推移添加功能。文件和网络 API 需要权限并可能需要游戏所有者的同意，因此这些可能不会在默认的 API 集合中，但我们可能会在以后添加这些功能（例如，可能针对服务器所有者）。

- **问**：所以这样的接口只会在部分可用平台上实现吗？

- **答**：我们努力在所有平台上实现所有 API。唯一的例外是如果我们引入一些仅限桌面的编辑器特定 API。

## 斜杠命令

- **问**：我们何时能够注册自定义斜杠命令？

- **答**：虽然我们没有具体的时间表，但这在我们的开发列表中优先级很高。

- **答**：当人们开始制作自己的 !commands 时，这一点已经非常明确。

## 测试 Vanilla

- **问**：你们目前是否使用 GameTests 框架来测试 Vanilla 行为包？或者，你们以何种方式在自己的内容上利用测试 API？

- **答**：是的！我们目前有很多 Vanilla 内容的测试，并希望随着时间的推移不断扩展。我们实际上在公共构建中发布了一些针对 Vanilla 内容的测试（vanilla_gametest）。

- **答**：理想情况下，随着时间的推移，社区也会通过 GameTest 报告 Vanilla 的错误，我们可以整合这些测试（修复问题后），确保不会再次破坏这些内容 🙂

## 时间表

- **问**：我们能获得 API 接下来计划添加哪些事件的时间表吗？

- **答**：我们的团队仍在决定接下来要添加哪些事件，因此没有太多时间表可以分享。你希望添加哪些事件？

- **答**：绝对同意将区块破坏/放置作为高优先级。

## GameTests 的政治

- **问**：是什么技术、结构或政治原因让 GameTests API 得以繁荣，而原始的脚本 API 却没有？你们这一次“做了什么不同”的事情？此外，需要发生什么才能使 GameTest 被认为是“成功”（因此不会被放弃）。我们能做些什么来帮助实现这一点？

- **答**：总体来说，我们试图专注于我们目标的场景，首先是内容测试和验证，这对于核心 Minecraft 以及 Minecraft 中的自定义内容来说都是非常需要的。我们真的希望让人们更容易围绕他们的内容构建测试。这种场景的需求也更有限（例如，我们可以支持更少的平台，性能不是那么大的问题，等等）。所以，我们专注于 GameTest，为了让它成功，我们希望看到内容创作者能够轻松测试他们的内容。

- **答**：当然，我们看到了未来更多场景的潜力——包括玩法——但在我们对性能等方面有更多验证，并支持更多平台，回应你们的反馈之前，我们真的不想让大家的期望值过高（或让大家在玩法的脚本/GameTest API 上打赌）。

- **答**：关于：我们能做些什么来帮助实现这一点？——继续与我们互动，改进和添加新内容！🙂 创作者社区是这一切的驱动力。

## 游戏主机

- **问**：游戏主机无法运行 GameTests 的原因是什么，未来游戏主机是否会支持 GameTest API？

- **答**：是的！我们计划支持所有平台，有几个平台没有我们 JS 引擎所需的所有 API，例如 aligned_alloc。我们正在积极工作以支持这些平台。

## 其他语言

- **问**：Gametest 是否会支持不同语言？

- **答**：我们已经将绑定层实现得足够通用，可以适应其他编程/脚本语言。在内部，我们做了一些有趣的事情，比如尝试使用 Lua，甚至像 Blockly 这样的东西。不过，目前我认为我们无法承诺添加任何官方的其他语言支持 🙂

- **问**：你们考虑过 Kotlin 吗？

- **答**：我还没有深入了解 Kotlin（我们所有的 Android 平台仍然用 Java 编写🙂），但听起来很不错！我会找时间看看。

## 事件系统

- **问**：看到数据驱动系统中也有事件系统。你们如何定位 GameTest 框架中的事件系统与数据驱动中的事件系统之间的关系？未来会提供两者之间的接口吗？

- **答**：我们希望这些系统能够很好地协同工作。如果你熟悉数据驱动的构建方式，我们希望你能够以合理的方式加入脚本。我们仍在研究具体的实现方式。

## 我们的“否定”清单中有内容吗？

- **问**：你能分享一些你们的“否定清单”中的内容吗？（你们讨论过但决定不单方面实现的事项）。这可能包括你们不会支持的某些设备，或不想让 API 走某些方向。几乎任何不在计划中的内容。

- **答**：好问题。我们的“绝对不”清单中几乎没有内容。

- **答**：以下是我们“极度谨慎使用”清单中的一些内容：

    - 网络访问

    - 文件访问

    - 平台特定 API

- **答**：网络访问可能会通过非常结构化的 API 针对特定目标允许。同样，文件访问：我们可能会有某种持久存储，但不是自由形式的文件。

- **答**：平台特定 API 是我们希望避免的内容。但我们可以想象在编辑器场景中实现桌面特定 API。我们会避免在玩法和 Gametest 场景中这样做。

- **答**：另一个我希望能公开但非常困难的是自定义着色器。PlayStation 要求着色器在提交时内置。因此，我们将通过提供基于物理的材质系统，在其中硬编码非常灵活的着色器来解决这个问题。

- **问**：关于所说的“持久存储”，我们是否会有一种方法以实例无关的方式写入和读取简单的整数变量？还是它仍然会在实例中，并在运行时结束时被删除？

- **答**：是的，我们计划添加键值对存储，可能是 JSON 存储。一种方式是通过 JavaScript API 访问标签和记分板。但进一步的可能是允许通用的读写存储（仍然不是直接的文件系统访问）。我们想要解决的一些安全问题是确保每个附加包的存储被沙盒化。

## 自定义维度

- **问**：如果可能，未来是否有计划支持在自定义维度上运行 GameTests？

- **答**：在设计 GameTest API 时，我们一直考虑自定义内容。这实际上就是为什么 Commands.run 接受一个字符串作为维度，而不是硬编码的维度变量。因此，我们绝对留有与自定义维度和其他自定义内容集成的可能性。

## 旧的脚本 API

- **问**：旧的脚本 API 会发生什么？它还会保留但不再更新吗？（也就是说，它永远不会变得不支持）

- **答**：原始的脚本 API 将会保留（正如你所注意到的，最近确实没有得到太多更新）。随着 GameTest API 和其他玩法逻辑系统的发展，如果它们可能涵盖脚本 v1 的功能，我们将移除脚本 v1 的功能。

- **答**：旧的脚本 API 是实验性的，因此几乎没有（或者说根本没有）向后兼容性的保证。而且旧的脚本 API 不支持移动设备，我们目前不会扩展其平台支持。

- **答**：我们确实希望支持客户端体验和类似 UI 的东西——我们有很多想法，但目前还没有确定的计划。

## 世界生成

- **问**：有没有计划在 GameTests 中公开世界噪声？JS 中存在噪声库，但需要的是用于生物群系生成/ Molang 查询的噪声。

- **答**：我们还没有仔细研究如何在脚本中允许世界生成的存在。区块生成运行在任务线程上，目前我们的 Gametest 实现不允许安全地迁移到其他线程。我们有一些类似于 web workers 的想法，但还没有超越讨论阶段。

## GameTests BDS

- **问**：Gametest 是否很快会在 BDS 上顺利运行？

- **答**：我们目前在 CI 流水线中使用 BDS 来运行 GameTest 并验证结果！

- **答**：是否有任何方面是 BDS 和 GameTest 不兼容的？

- **答**：GameTest 可能无法工作的一个原因是世界需要启用实验，这在专用服务器上不容易实现。目前最简单的方法是使用 Minecraft 客户端生成启用了 GameTest 实验的世界，然后将世界传输到专用服务器。

## 学习 JS

- **问**：作为刚开始学习 JavaScript 的人，有什么推荐的资源可以帮助新编码者学习 Gametests 吗？更多是在 Gametests 的上下文中，而不是一般的 JS。

- **答**：太棒了！JavaScript 是开始编程的好方式 🙂

- **答**：我们这里有一篇超级小的文章，介绍如何构建你的第一个 GameTest：https://docs.microsoft.com/en-us/minecraft/creator/documents/gametestbuildyourfirstgametest

- **答**：希望我们很快会有更多内容！

- **问**：备注：如果你想为这些指南做贡献，我们很乐意！

## Beta BDS

- **问**：有没有计划向公众发布 BDS 的测试版本，以帮助我们更好地调试和诊断 Gametests 中的问题？

- **答**：感谢你的建议。我想这么做。我会与我们的发布管理团队跟进，看看是否可能。

## NPM

- **问**：Gametest 是否支持 npm 库？

- **答**：原生我们不支持 NPM 库，但我们在使用 WebPack “打包”这些包时取得了一些有限的成功。

- **答**：还有！！我们的官方 TypeScript 绑定即将发布🙂我们已经在这里分享了一些早期版本，但我们越来越接近发布它们了。

- **问**：Gametest 是否会有类似 npm 的包管理器？

- **答**：我们有考虑过，但这需要大量工作。我们会继续思考🙂我认为随着越来越多的人开始使用脚本，我们会看到一些自然的开发模式出现，我们会想要利用这些模式。

## GameTests 的最终目标

- **问**：GameTests 的最终目标是什么？它会保持作为一个测试工具，还是会扩展到其他领域，或许添加全新的内容？

- **答**：对于 GameTest，我们希望使内容测试和验证变得更容易。我们希望人们能够简单地围绕他们的内容、装置和脚本构建测试。这部分包括一个丰富的脚本 API，用于模拟和测试断言，我们已经用 GameTest 模块构建了这些内容。我们还将向 GameTest 添加一些新的 API，包括一些用于模拟环境中玩家的非常酷的方法。我们也在努力寻找使这些基于 JavaScript 的测试更容易创建的方法。

- **答**：当然，GameTest 的一个令人愉快的副产品是有机会构建一个更通用的基于服务器的脚本 API，这也帮助我们探索它在未来场景中的使用方式。

## 实验模块

- **问**：你们过去指出希望所有命令都能成为 API。如果有实验性功能到来，它会获得 API 支持吗？如果是，会在实验模块中吗？

- **答**：我们绝对希望为实验性功能提供 API。我们还没有决定具体的实现方式。也许是一个单独的模块，比如 mojang-minecraft-experimental 之类的？这将类似于 C++ 如何在实验性命名空间中处理尚未标准化的类型。

## 开发 GameTests API

- **问**：在开发 GameTests API 时，最酷的部分是什么？有没有特别的设计决策或技术方面让你感到非常满意或有趣的实现？

- **答**：对我个人来说，是创建一个绑定层 + 消费者，允许支持多种脚本语言。

- **答**：我们的想法是每个附加包都可以选择使用哪种脚本运行时🙂

- **问**：太棒了！未来有机会支持 Python 吗？

- **答**：在一次 Game Jam 中，我实际上以一种非常黑客的方式让 Python 2.7 工作了，但我们目前没有这方面的产品计划。

## API 覆盖范围

- **问**：当前的一些方法是否也会对玩家可用？比如物品堆叠方法。

- **答**：你可以在这里查看最新的 API 列表：https://docs.microsoft.com/en-us/minecraft/creator/scriptapi/mojang-minecraft/player

- **答**：注意：API 表面仍然有点小，我们正在慢慢增加更多内容！

## GameTests 替代命令方块

- **问**：GameTests 会替代命令方块吗？

- **答**：我不认为脚本会替代命令方块，但我确实看到很多“重逻辑”转移到脚本中。理想情况下，它们会紧密协作（比如在脚本中注册一个自定义命令，并让命令方块执行它）。

## 教育版代码构建器

- **问**：有没有计划让 gametest API 更加易用，比如教育版的代码构建器？

- **答**：我们已经开始研究在 GameTest 中使用 Blockly（可视化编程）。目前没有具体的报告，但我觉得这会非常酷！

## 最有趣的 Bug

- **问**：在开发 gametest 过程中，发生过的最有趣的 Bug 是什么？

- **答**：有一个有趣的 Bug，之前我在测试驯服 API 时，想看看如果生成并驯服 100 多只狼会发生什么……https://imgur.com/a/NIF7D4x

## 市场

- **问**：GameTests 对市场会有多大影响？

- **答**：目前，GameTest 是一个实验性功能，因此无法与市场内容一起包含。我们确实认为 GameTest 对于在内容进入市场之前帮助验证内容是很好的“辅助”工具。

## Realms

- **问**：Game Test 在 Realms 上的未来是什么？它会像旧的脚本 API 一样保留在 Realms 上，还是会被移除？

- **答**：我们的意图是将 Gametest（及后续的玩法脚本）发布到 Realms 上。因此，我们不会期望随后弃用它。

## GameTests 是否为通用用途？

- **问**：考虑到社区对 gametests 的主要利用方式是将其作为最终产品的一部分（类似脚本引擎的设计用途），而不是严格在生产过程中用于捕捉错误，你们是否认为 gametests 会被重新定位以服务于更通用的应用并成长为附加包的支持功能？

- **答**：我们目前专注于 GameTest 进行内容测试。在支持用于通用玩法目的的脚本 API 之前，我们希望通过更多的测试和添加更多的基础设施，确定何时以及如何将这些脚本 API 从实验性中转出，以便在这些角色中使用。

## Molang

- **问**：可以通过 GameTest API 测试 Molang 吗？

- **答**：你可以通过多种方式测试实体行为。当然，实体可以在其动画控制器和实体状态转换条件中使用 Molang。

- **答**：你有具体想要覆盖的内容吗？

- **答**：应该提到，你可以通过在运行 game test 时将你的自定义实体的行为包加入堆栈，来在自定义实体上使用 GameTest。

## 社区反馈

- **问**：新的 Gametest 功能是基于 Mojang 的测试需求还是社区的反馈/请求而计划或添加的？这会有改变吗？

- **答**：绝对是两者的结合！我们一直在添加一些新的 GameTest API 来测试一些 Vanilla 行为，但我们也想知道你们感兴趣的 API。

- **答**：一个很好的例子是自定义命令 API。这在我们的添加列表中很高，因为社区一直在要求它 :smile:

- **答**：还有一些其他功能即将推出，使 gametests 更强大且更易于创建：模拟玩家 API 和在 Visual Studio Code 中调试脚本。

## 平台效率

- **问**：它与其他平台的兼容性如何/总体效率如何？

- **答**：我们预计将在所有平台上启用它。关于性能，我们确实需要在支持即时编译的平台和不支持的平台之间进行优化。这是我们已知的一个大分析和性能调整领域。

- **问**：“总体效率”是指 API 与底层的接近程度吗？

- **答**：感谢你对效率的澄清：我们的 API 将尝试与数据驱动系统“良好协作”作为起点。因此，在 Minecraft 实体、物品、区块等抽象层次上操作。如果你熟悉 Bukkit，我们试图达到类似的抽象层次（加上我们雄心中的客户端侧附加内容）。

## 命名原因

- **问**：为什么叫做 GameTest？

- **答**：我们基于 Java 的一些工作进行开发。他们构建了一个初始的 GameTest 框架，用于他们的测试过程。

- **答**：顺便问一下，计划将整个系统称为 gametests 还是其他名称？

- **答**：如果我们超越测试场景，将整个 JS API 集合称为 GameTest 可能不太合理。你可以在整体 API 命名中看到一些相关思考。

## 为什么选择 Gametests？

- **问**：你们在设计 gametest 时的意图是什么，或者在考虑它的用途时有哪些想法？

- **答**：基本上：测试游戏！允许在不需要重新编译的情况下向游戏添加测试是一个很棒的工具。我们可以更快地进行测试，社区成员在报告错误时可以编写测试。

- **答**：GameTest 也是我们在让脚本在 Minecraft 中运行方面的一个很好的“试验场”。

## Gametest 的限制是什么？

- **问**：Gametest 的限制是什么？

- **答**：只有你的想象力！

- **答**：说真的，我们有一些限制：结构限于 64x64x64。我们目前只在主世界维度运行，但我们希望扩大这一点。

- **答**：我们目前不支持与玩家的交互，但这正在深入开发中。

- **答**：Gametest 在移动设备上是可行的。我们正在解决它目前不支持的两个平台：Switch 和 PlayStation。

- **问**：我能嵌套多少个 for 循环才会导致游戏崩溃？

- **答**：事实上，这是个好问题。目前如果你使用 while (true)，游戏会挂起。但我们已经进行了原型设计，并计划构建一个“看门狗”，能够检测并阻止这种情况。

- **答**：我们的看门狗原型不仅做了这些。它还能够监控脚本对象数量和内存，以及周期数。（并且跨语言运行时工作，所以很酷）

## 热重载

- **问**：是否有任何简单的方法可以像 /reload 命令用于函数一样，从游戏内部重新加载 gametest API 文件？快速重新加载的能力确实使调试和一般工作变得更加容易和愉快。

- **答**：作为一个编写了大量 gametest JS 的人，确实在我们的思考和路线图上，有更容易重新加载 JS 的方法。

## 文档

- **问**：gametests 的文档是让我难以入门的原因之一。是否有计划使文档更易访问，让人们更容易从基础了解如何使用这个框架？

- **答**：我们最近发布了一个新的创作者门户，其中包括如何开始使用 GameTest 的文章。https://docs.microsoft.com/en-us/minecraft/creator/documents/gametestgettingstarted

- **答**：API 文档相对较新，所以在提供详细文档和示例方面还有很长的路要走。文档托管在 GitHub 上，因此如果社区中的人希望贡献，欢迎提交 PR。https://github.com/MicrosoftDocs/minecraft-creator/tree/main/creator/ScriptAPI

## Hummingbird UI

- **问**：gametest 会取代 scripting 在 Hummingbird UI 中的角色吗？

- **答**：Hummingbird 是 GameFace 的前身（https://coherent-labs.com/products/coherent-gameface/）。这是我们用于构建新的 Bedrock UI 的 UI 技术。

- **答**：我们确实计划允许脚本创建或修改 UI。不过，我们希望它能以自然的方式与内置 UI 协作，我们仍在研究这将如何工作。

- **答**：我们不期望在与 GameFace JS 相同的沙盒中运行。此外，目前我们专注于服务器端，GameFace 只在客户端运行。

## 外部脚本

- **问**：gametest 会与外部脚本协作吗？这样它们可以与在另一个目录中运行的脚本通信？

- **答**：我们确实希望提供一种方式，让脚本可以依赖于其他脚本——例如，可能是一个非常好的测试脚本，或用于地形生成的脚本——但这可能是通过行为包的依赖系统来实现。我认为我们还没有办法从任意位置加载 JS。

- **答**：是的，让外部脚本在所有平台上协作将会是一个挑战，也是潜在的安全挑战。

## 市场

- **问**：gametests 会为市场内容提供支持吗？如果会，有大致的发布时间吗？

- **答**：目前我们的重点是测试场景。虽然我们有很多未来的想法和计划，但我们不想让大家制定计划或依赖我们尚不能承诺的任何东西。

## Discord

- **问**：gametest 是否能够将 Discord 连接到 Minecraft？

- **答**：在最初的版本中，可能不会🙂。

## Java 一致性

- **问**：许多带有 suite:java_parity 标签的 Vanilla 游戏测试被禁用，可能是因为行为不正确。这些测试是从 Java 的测试套件中移植过来的吗？这些测试的目的是什么？

- **答**：我们在构建这个框架时，参考了 Java 内部的一些 GameTest 工作，这些测试也被移植过来。我们还希望迁移并跟踪 Java 中的一些测试，即使 Java 和 Bedrock 之间存在一致性差异，可能会阻止它们以相同的方式工作。

- **问**：看到这些被禁用的一致性测试作为移植更多 Java 行为的任务清单会很好，我们确实可以提供更多，哈哈哈……

- **答**：如果你编写了一个演示 Java 一致性问题的游戏测试，我们很愿意收录：https://aka.ms/gametestsamples

- **答**：是的，我们正在通过游戏测试跟踪通过错误发现的一致性问题。

- **问**：如果 gametests 开放以这种方式贡献，我们是否有任何方式可以贡献到实际的 Vanilla 行为/资源包？

- **答**：我们目前正在讨论是否应该将“内置”游戏测试移动到同一个仓库，并使其更容易获取开源行为包。